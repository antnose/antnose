name: Generate Connect Cards
on:
  schedule:
    - cron: "0 0 * * *"
  workflow_dispatch:
  push:
    branches: [main]

jobs:
  generate:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Create Connect Cards
        run: |
          cat > generate-connect-cards.js << 'EOF'
          const fs = require('fs');

          const commonStyle = `
          <style>
            @keyframes float {
              0%, 100% { transform: translateY(0px); }
              50% { transform: translateY(-10px); }
            }
            @keyframes fadeInUp {
              from { opacity: 0; transform: translateY(20px) scale(0.95); }
              to { opacity: 1; transform: translateY(0) scale(1); }
            }
            @keyframes borderGlow {
              0%, 100% { stroke: #30363d; }
              50% { stroke: var(--hover-color); }
            }
            .card { 
              fill: #0d1117; 
              stroke: #30363d; 
              rx: 20; 
              transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
              filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
              animation: fadeInUp 0.8s ease-out forwards;
              cursor: pointer;
            }
            .card:hover { 
              transform: translateY(-8px) scale(1.02);
              stroke-width: 2;
              filter: drop-shadow(0 10px 20px rgba(var(--hover-rgb), 0.2));
            }
            .card-glow {
              animation: borderGlow 3s ease-in-out infinite;
            }
            .text { 
              font-family: 'Segoe UI', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; 
              fill: #ffffff; 
              font-weight: 500;
            }
            .label { 
              fill: #8b949e; 
              font-size: 12px; 
              font-weight: 600;
              letter-spacing: 0.5px;
              text-transform: uppercase;
            }
            .value { 
              animation: fadeInUp 1s ease-out forwards;
              animation-delay: 0.3s;
              opacity: 0;
            }
            .accent-text {
              animation: float 3s ease-in-out infinite;
            }
          </style>`;

          const platforms = [
            {
              name: 'PORTFOLIO',
              icon: 'ðŸŒ',
              color: '#6dd5ed',
              hoverColor: '#2193b0',
              link: 'https://antnose.vercel.app/',
              gradient: 'portfolioGradient',
              description: 'Personal Website',
              stat: 'Latest Projects'
            },
            {
              name: 'TWITTER',
              icon: 'ð•',
              color: '#1DA1F2',
              hoverColor: '#1a8cd8',
              link: 'https://x.com/_antnose',
              gradient: 'twitterGradient',
              description: 'Tech Thoughts',
              stat: 'Daily Updates'
            },
            {
              name: 'LINKEDIN',
              icon: 'in',
              color: '#0A66C2',
              hoverColor: '#004182',
              link: 'https://www.linkedin.com/in/antnose/',
              gradient: 'linkedinGradient',
              description: 'Professional',
              stat: 'Network'
            },
            {
              name: 'STACK',
              icon: 'SO',
              color: '#F48024',
              hoverColor: '#e76b11',
              link: 'https://stackoverflow.com/users/29213804/ant-nose',
              gradient: 'stackGradient',
              description: 'Stack Overflow',
              stat: 'Q&A Expert'
            },
            {
              name: 'GITHUB',
              icon: 'ðŸ™',
              color: '#bc8cff',
              hoverColor: '#6e40c9',
              link: 'https://github.com/antnose',
              gradient: 'githubGradient',
              description: 'Open Source',
              stat: 'Repositories'
            }
          ];

          const createCard = (platform, index) => {
            const hoverRgb = hexToRgb(platform.hoverColor);
            const animationDelay = 0.1 * (index + 1);
            
            return `
            <svg xmlns="http://www.w3.org/2000/svg" width="320" height="160" viewBox="0 0 320 160">
              ${commonStyle}
              <defs>
                <linearGradient id="${platform.gradient}" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" stop-color="${platform.color}" />
                  <stop offset="100%" stop-color="${platform.hoverColor}" />
                </linearGradient>
              </defs>
              
              <a href="${platform.link}" target="_blank">
                <rect class="card card-glow" width="316" height="156" x="2" y="2" rx="20" 
                      style="--hover-color: ${platform.hoverColor}; --hover-rgb: ${hoverRgb}; animation-delay: ${animationDelay}s"/>
                
                <rect width="316" height="156" x="2" y="2" rx="20" fill="url(#${platform.gradient})" opacity="0.1"/>
                
                <!-- Platform Name -->
                <text x="25" y="45" class="text label" style="animation-delay: ${animationDelay + 0.1}s">${platform.name}</text>
                
                <!-- Icon -->
                <g style="opacity: 0.8; animation-delay: ${animationDelay + 0.2}s">
                  <circle cx="280" cy="80" r="30" fill="url(#${platform.gradient})" opacity="0.2"/>
                  <text x="280" y="85" text-anchor="middle" font-size="${platform.name === 'PORTFOLIO' || platform.name === 'GITHUB' ? '24' : '20'}" 
                        fill="url(#${platform.gradient})">${platform.icon}</text>
                </g>
                
                <!-- Description -->
                <text x="25" y="85" class="text value" font-size="28" font-weight="bold" fill="url(#${platform.gradient})"
                      style="animation-delay: ${animationDelay + 0.3}s">${platform.description}</text>
                
                <!-- Stats -->
                <text x="25" y="110" class="text" font-size="10" fill="#8b949e" style="animation-delay: ${animationDelay + 0.4}s">
                  ${platform.stat}
                </text>
                
                <!-- Click Hint -->
                <text x="25" y="130" class="text" font-size="10" fill="${platform.color}" style="animation-delay: ${animationDelay + 0.5}s">
                  Click to visit â†’
                </text>
                
                <!-- Decorative Elements -->
                <circle cx="25" cy="140" r="3" fill="url(#${platform.gradient})" class="accent-text" 
                        style="animation-delay: ${animationDelay + 0.6}s"/>
                <circle cx="40" cy="140" r="2" fill="url(#${platform.gradient})" class="accent-text" 
                        style="animation-delay: ${animationDelay + 0.7}s"/>
              </a>
            </svg>`;
          };

          function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? 
              parseInt(result[1], 16) + ', ' + parseInt(result[2], 16) + ', ' + parseInt(result[3], 16) : 
              '88, 166, 255';
          }

          // Generate individual cards
          platforms.forEach((platform, index) => {
            const fileName = platform.name.toLowerCase().replace(/\s+/g, '_') + '.svg';
            fs.writeFileSync(fileName, createCard(platform, index));
            console.log('Generated: ' + fileName);
          });

          console.log('âœ… All 5 connect cards generated successfully!');
          EOF
          node generate-connect-cards.js

      - name: Push Cards
        run: |
          git config --global user.email "actions@github.com"
          git config --global user.name "GitHub Actions"
          git add portfolio.svg twitter.svg linkedin.svg stack.svg github.svg
          git commit -m "âœ¨ Generated 5 connect cards matching GitHub metrics design" || exit 0
          git push
