name: Generate Connect Card
on:
  schedule:
    - cron: "0 0 * * *"
  workflow_dispatch:
  push:
    branches: [main]

jobs:
  generate:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Create Connect Card
        run: |
          cat > generate-connect.js << 'EOF'
          const fs = require('fs');

          const commonStyle = `
          <style>
            @keyframes floatCard {
              0%, 100% { transform: translateY(0); }
              50% { transform: translateY(-5px); }
            }
            @keyframes fadeInUp {
              from { opacity: 0; transform: translateY(20px); }
              to { opacity: 1; transform: translateY(0); }
            }
            @keyframes pulseGlow {
              0%, 100% { filter: drop-shadow(0 0 5px currentColor); }
              50% { filter: drop-shadow(0 0 15px currentColor); }
            }
            @keyframes borderFlow {
              0% { stroke-dashoffset: 0; }
              100% { stroke-dashoffset: 50; }
            }
            @keyframes iconFloat {
              0%, 100% { transform: translateY(0) scale(1); }
              50% { transform: translateY(-8px) scale(1.1); }
            }
            .connect-card {
              fill: #0d1117;
              stroke: #30363d;
              rx: 20;
              animation: fadeInUp 0.8s ease-out forwards;
              filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.3));
              transition: all 0.3s ease;
            }
            .connect-card:hover {
              stroke: #58a6ff;
              stroke-width: 2;
              filter: drop-shadow(0 10px 25px rgba(88, 166, 255, 0.2));
              animation: floatCard 3s ease-in-out infinite;
            }
            .border-animated {
              stroke-dasharray: 10, 5;
              animation: borderFlow 4s linear infinite;
            }
            .title-text {
              font-family: 'Segoe UI', 'Inter', sans-serif;
              fill: #58a6ff;
              font-size: 16px;
              font-weight: 700;
              letter-spacing: 1px;
              text-transform: uppercase;
              animation: fadeInUp 0.8s ease-out forwards;
              opacity: 0;
            }
            .subtitle-text {
              font-family: 'Segoe UI', 'Inter', sans-serif;
              fill: #8b949e;
              font-size: 12px;
              animation: fadeInUp 1s ease-out forwards;
              opacity: 0;
            }
            .platform-card {
              cursor: pointer;
              transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
              animation: fadeInUp 1s ease-out forwards;
              opacity: 0;
            }
            .platform-card:hover {
              transform: translateY(-10px) scale(1.05);
            }
            .platform-card:hover .icon-bg {
              fill-opacity: 0.3;
            }
            .platform-card:hover .platform-name {
              fill: #ffffff;
              font-weight: 600;
            }
            .icon-bg {
              transition: all 0.4s ease;
              animation: iconFloat 4s ease-in-out infinite;
            }
            .platform-name {
              font-family: 'Segoe UI', 'Inter', sans-serif;
              fill: #c9d1d9;
              font-size: 12px;
              font-weight: 500;
              transition: all 0.3s ease;
            }
            .icon-text {
              font-weight: bold;
              animation: pulseGlow 3s ease-in-out infinite;
            }
            .connector-dot {
              animation: pulseGlow 2s ease-in-out infinite;
            }
            .stats-text {
              font-family: 'Segoe UI', 'Inter', sans-serif;
              fill: #8b949e;
              font-size: 10px;
              font-style: italic;
            }
          </style>
          
          <defs>
            <linearGradient id="connectGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#58a6ff" />
              <stop offset="100%" stop-color="#bc8cff" />
            </linearGradient>
            <linearGradient id="portfolioGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#2193b0" />
              <stop offset="100%" stop-color="#6dd5ed" />
            </linearGradient>
            <linearGradient id="twitterGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#1DA1F2" />
              <stop offset="100%" stop-color="#1a8cd8" />
            </linearGradient>
            <linearGradient id="linkedinGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#0A66C2" />
              <stop offset="100%" stop-color="#004182" />
            </linearGradient>
            <linearGradient id="stackGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#F48024" />
              <stop offset="100%" stop-color="#e76b11" />
            </linearGradient>
            <linearGradient id="githubGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#6e40c9" />
              <stop offset="100%" stop-color="#bc8cff" />
            </linearGradient>
            <filter id="connectShadow">
              <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="rgba(88, 166, 255, 0.15)"/>
            </filter>
          </defs>`;

          const platforms = [
            {
              name: 'Portfolio',
              icon: 'ðŸŒ',
              gradient: 'portfolioGradient',
              color: '#6dd5ed',
              link: 'https://antnose.vercel.app/',
              x: 90,
              delay: '0.5s'
            },
            {
              name: 'Twitter',
              icon: 'ð•',
              gradient: 'twitterGradient',
              color: '#1DA1F2',
              link: 'https://x.com/_antnose',
              x: 190,
              delay: '0.6s'
            },
            {
              name: 'LinkedIn',
              icon: 'in',
              gradient: 'linkedinGradient',
              color: '#0A66C2',
              link: 'https://www.linkedin.com/in/antnose/',
              x: 290,
              delay: '0.7s'
            },
            {
              name: 'Stack',
              icon: 'SO',
              gradient: 'stackGradient',
              color: '#F48024',
              link: 'https://stackoverflow.com/users/29213804/ant-nose',
              x: 390,
              delay: '0.8s'
            },
            {
              name: 'GitHub',
              icon: 'ðŸ™',
              gradient: 'githubGradient',
              color: '#bc8cff',
              link: 'https://github.com/antnose',
              x: 490,
              delay: '0.9s'
            }
          ];

          const createPlatformCard = (platform) => `
            <g class="platform-card" transform="translate(${platform.x}, 85)" style="animation-delay: ${platform.delay}">
              <a href="${platform.link}" target="_blank">
                <circle class="icon-bg" cx="0" cy="0" r="25" fill="url(#${platform.gradient})" fill-opacity="0.15"/>
                <text x="0" y="5" text-anchor="middle" class="icon-text" font-size="${platform.name === 'Portfolio' || platform.name === 'GitHub' ? '22' : '18'}" fill="url(#${platform.gradient})">${platform.icon}</text>
                <text x="0" y="38" text-anchor="middle" class="platform-name">${platform.name}</text>
              </a>
            </g>
          `;

          const currentDate = new Date().toLocaleDateString('en-US', { 
            month: 'short', 
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
          });

          const svg = `
          <svg xmlns="http://www.w3.org/2000/svg" width="660" height="170" viewBox="0 0 660 170">
            ${commonStyle}
            
            <!-- Main Card -->
            <rect class="connect-card" width="656" height="166" x="2" y="2" rx="20"/>
            <rect class="connect-card border-animated" width="656" height="166" x="2" y="2" rx="20" fill="none" stroke="url(#connectGradient)" stroke-width="1.5"/>
            
            <!-- Title -->
            <text x="330" y="35" text-anchor="middle" class="title-text" style="animation-delay: 0.2s">
              ðŸ”— CONNECT & COLLABORATE
            </text>
            <text x="330" y="55" text-anchor="middle" class="subtitle-text" style="animation-delay: 0.4s">
              Let's build something amazing together â€¢ Always open for new opportunities
            </text>
            
            <!-- Platforms -->
            ${platforms.map(createPlatformCard).join('')}
            
            <!-- Connector Dots -->
            <circle cx="140" cy="85" r="3" fill="#58a6ff" class="connector-dot" style="animation-delay: 1s"/>
            <circle cx="240" cy="85" r="3" fill="#1DA1F2" class="connector-dot" style="animation-delay: 1.1s"/>
            <circle cx="340" cy="85" r="3" fill="#0A66C2" class="connector-dot" style="animation-delay: 1.2s"/>
            <circle cx="440" cy="85" r="3" fill="#F48024" class="connector-dot" style="animation-delay: 1.3s"/>
            
            <!-- Footer Stats -->
            <g transform="translate(330, 145)">
              <text x="0" y="0" text-anchor="middle" class="stats-text">
                Updated: ${currentDate}
              </text>
              <text x="0" y="12" text-anchor="middle" class="stats-text">
                â€¢ Click any platform to connect â€¢ Response time: &lt; 24h â€¢
              </text>
            </g>
          </svg>`;

          fs.writeFileSync('connect_card.svg', svg);
          console.log('âœ… Connect card generated successfully!');
          EOF
          node generate-connect.js

      - name: Push Card
        run: |
          git config --global user.email "actions@github.com"
          git config --global user.name "GitHub Actions"
          git add connect_card.svg
          git commit -m "âœ¨ Generated new Connect Card matching GitHub Metrics" || exit 0
          git push
